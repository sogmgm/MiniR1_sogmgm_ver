# ê°œë°œ ì§„í–‰ ìƒí™©

> ìµœì¢… ì—…ë°ì´íŠ¸: 2025ë…„ 11ì›” 10ì¼

## ğŸ“‹ ì „ì²´ ì§„í–‰ í˜„í™©

- [x] âœ… í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ì •
- [ ] â³ RunPod í™˜ê²½ êµ¬ì„± (UV + PyTorch)
- [ ] â³ ë°ì´í„°ì…‹ ì¤€ë¹„
- [ ] â³ ë³´ìƒ í•¨ìˆ˜ êµ¬í˜„
- [ ] â³ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
- [ ] â³ í•™ìŠµ ì‹¤í–‰
- [ ] â³ ê²°ê³¼ ë¶„ì„

---

## ğŸ—“ï¸ ì‘ì—… ë¡œê·¸

### 2025-11-10

#### âœ… í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì • ì™„ë£Œ
- [x] README.md ì‘ì„± ì™„ë£Œ
- [x] PROGRESS.md ìƒì„±
- [x] í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡° ì™„ì„±
- [x] RunPod + UV ê¸°ë°˜ ê°œë°œ ì „ëµ ìˆ˜ë¦½

#### âœ… í•µì‹¬ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ì™„ë£Œ
- [x] `pyproject.toml` - UV íŒ¨í‚¤ì§€ ê´€ë¦¬ ì„¤ì •
- [x] `scripts/dataset_prep.py` - ë°ì´í„°ì…‹ ì „ì²˜ë¦¬
- [x] `scripts/rewards.py` - ë³´ìƒ í•¨ìˆ˜ êµ¬í˜„ + í…ŒìŠ¤íŠ¸
- [x] `scripts/train_grpo.py` - GRPO í•™ìŠµ ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸
- [x] `scripts/check_environment.py` - í™˜ê²½ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸
- [x] `configs/training_config.yaml` - GPU ìµœì í™” ì„¤ì •

#### âœ… RunPod ì‹¤í–‰ ê°€ì´ë“œ ì™„ì„±
- [x] `RUNPOD_SETUP.md` - ìˆœì°¨ ì‹¤í–‰ ê°€ì´ë“œ ì‘ì„±
  - GPU ì¶”ì²œ ë° ë¹„ìš© ë¶„ì„
  - Step-by-step ìˆ˜ë™ ì„¤ì • ë°©ë²•
  - ë¬¸ì œ í•´ê²° ê°€ì´ë“œ
  - ì²´í¬ë¦¬ìŠ¤íŠ¸ ë° ì˜ˆìƒ ê²°ê³¼

**ì£¼ìš” ê²°ì • ì‚¬í•­**:
1. **GPU ë©”ëª¨ë¦¬ ìµœì í™” ìš°ì„ **: ë‹¨ì¼ GPU (12-16GB VRAM)ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„
2. **UV íŒ¨í‚¤ì§€ ê´€ë¦¬ì ì‚¬ìš©**: RunPod í™˜ê²½ì—ì„œ ë¹ ë¥¸ ì˜ì¡´ì„± ê´€ë¦¬
3. **ê²½ëŸ‰í™” ì „ëµ**:
   - ë°ì´í„°ì…‹: 5k-10k ìƒ˜í”Œ (ì›ë³¸ 50k â†’ 90% ê°ì†Œ)
   - í•™ìŠµ ìŠ¤í…: 200 steps (ì›ë³¸ 450 â†’ 55% ê°ì†Œ)
   - ëª¨ë¸ í¬ê¸°: Qwen2.5-1.5B/3B (í•„ìš”ì‹œ ë” ì‘ì€ ëª¨ë¸)
   - ì‹œí€€ìŠ¤ ê¸¸ì´: 512 tokens (ì›ë³¸ 1024 â†’ 50% ê°ì†Œ)

**ê¸°ìˆ  ìŠ¤íƒ ìµœì¢… í™•ì •**:
- âœ… íŒ¨í‚¤ì§€ ê´€ë¦¬: UV (RunPod ìµœì í™”)
- âœ… ëª¨ë¸: Qwen2.5-1.5B/3B-Instruct
- âœ… ì–‘ìí™”: QLoRA (4-bit)
- âœ… Attention: Flash Attention 2 (ì„ íƒ)
- âœ… í•™ìŠµ ë°©ì‹: ë‹¨ì¼ GPU GRPO
- âœ… ë¡œê¹…: íŒŒì¼ ê¸°ë°˜ (TensorBoard ì œì™¸)
- âœ… ìë™í™”: ìˆ˜ë™ ì‹¤í–‰ (ìˆœì°¨ ê°€ì´ë“œ)

**RunPod ì‹¤í–‰ ì¤€ë¹„ ì™„ë£Œ**:
- âœ… ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ì™„ë£Œ
- âœ… ì„¤ì • íŒŒì¼ ì¤€ë¹„ ì™„ë£Œ
- âœ… ìƒì„¸ ì‹¤í–‰ ê°€ì´ë“œ ë¬¸ì„œí™” ì™„ë£Œ
- â­ï¸ RunPod ì—…ë¡œë“œ í›„ Step 4ë¶€í„° ì‹¤í–‰ ê°€ëŠ¥

#### âœ… ë¡œì»¬ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [x] ë³´ìƒ í•¨ìˆ˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (`python3 scripts/rewards.py`)
  - âœ… Format Reward: 5/5 í†µê³¼
  - âœ… Equation Reward: 5/5 í†µê³¼
  - âœ… Combined Reward: 5/5 í†µê³¼
- [x] ì •ê·œì‹ íŒ¨í„´ ê²€ì¦ ì™„ë£Œ
- [x] ìˆ˜ì‹ í‰ê°€ ë¡œì§ ê²€ì¦ ì™„ë£Œ
- [x] í•œêµ­ì–´ ì£¼ì„ ë° ì˜ˆì‹œ ì¶”ê°€ ì™„ë£Œ
  - ê° í•¨ìˆ˜ë³„ ìƒì„¸ ì„¤ëª…
  - ì˜¬ë°”ë¥¸/ì˜ëª»ëœ ì˜ˆì‹œ í¬í•¨
  - Step-by-step ë¡œì§ ì„¤ëª…

#### âœ… í•™ìŠµ ëª¨ë‹ˆí„°ë§ ê¸°ëŠ¥ ì¶”ê°€
- [x] `save_completion_samples()` - ìƒì„± ìƒ˜í”Œ ìë™ ì €ì¥
  - ì „ì²´ ìƒ˜í”Œ ì €ì¥ (`step_XXXX_all.txt`)
  - ì„±ê³µ ìƒ˜í”Œë§Œ ì €ì¥ (`step_XXXX_success.txt`)
  - ì„±ê³µë¥  ìë™ ê³„ì‚°
- [x] `update_progress_md()` - PROGRESS.md ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
  - í•™ìŠµ ë©”íŠ¸ë¦­ í…Œì´ë¸” ìë™ ìƒì„±
  - Stepë³„ ì„±ê³¼ ì¶”ì 
- [x] `SampleSavingCallback` - Trainer ì½œë°± êµ¬í˜„
- [x] `completion_samples/README.md` - ìƒ˜í”Œ ë¶„ì„ ê°€ì´ë“œ

#### âœ… í‰ê°€ ë„êµ¬ ì™„ì„±
- [x] `scripts/evaluate.py` - ì²´í¬í¬ì¸íŠ¸ í‰ê°€ ìŠ¤í¬ë¦½íŠ¸
  - ëª¨ë¸ ë¡œë”© ë° ìƒ˜í”Œ ìƒì„±
  - ìë™ ë³´ìƒ ê³„ì‚°
  - ë©”íŠ¸ë¦­ ì§‘ê³„ (format acc, equation acc, success rate)
  - ê²°ê³¼ JSON ì €ì¥
  - ì„±ê³µ ìƒ˜í”Œ ì˜ˆì‹œ ì¶œë ¥

#### âœ… TensorBoard ì¶”ê°€ (ê°€ë²¼ìš´ ì„¤ì •)
- [x] `pyproject.toml`ì— tensorboard ì˜ì¡´ì„± ì¶”ê°€
- [x] `training_config.yaml` ì„¤ì • ì—…ë°ì´íŠ¸
  - `logging_steps: 25` (5 â†’ 25, ë©”ëª¨ë¦¬ ì ˆì•½)
  - `report_to: ["tensorboard"]` í™œì„±í™”
  - `logging_dir: "logs/tensorboard"`
- [x] RUNPOD_SETUP.mdì— TensorBoard ì‚¬ìš©ë²• ì¶”ê°€

---

## âœ¨ í”„ë¡œì íŠ¸ ì™„ì„±!

**ëª¨ë“  í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ** ğŸ‰

### ğŸ“‚ ìµœì¢… íŒŒì¼ êµ¬ì¡°
```
MiniR1/
â”œâ”€â”€ README.md                     âœ… í”„ë¡œì íŠ¸ ê°œìš”
â”œâ”€â”€ PROGRESS.md                   âœ… ê°œë°œ ì§„í–‰ ê¸°ë¡
â”œâ”€â”€ RUNPOD_SETUP.md              âœ… RunPod ì‹¤í–‰ ê°€ì´ë“œ
â”œâ”€â”€ pyproject.toml               âœ… UV íŒ¨í‚¤ì§€ ì„¤ì •
â”œâ”€â”€ .gitignore                   âœ…
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ training_config.yaml     âœ… í•™ìŠµ ì„¤ì •
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ check_environment.py     âœ… í™˜ê²½ ê²€ì¦
â”‚   â”œâ”€â”€ dataset_prep.py          âœ… ë°ì´í„° ì „ì²˜ë¦¬
â”‚   â”œâ”€â”€ rewards.py               âœ… ë³´ìƒ í•¨ìˆ˜ (í•œêµ­ì–´ ì£¼ì„)
â”‚   â”œâ”€â”€ train_grpo.py            âœ… GRPO í•™ìŠµ (ëª¨ë‹ˆí„°ë§ í¬í•¨)
â”‚   â””â”€â”€ evaluate.py              âœ… ëª¨ë¸ í‰ê°€
â”œâ”€â”€ completion_samples/
â”‚   â””â”€â”€ README.md                âœ… ìƒ˜í”Œ ë¶„ì„ ê°€ì´ë“œ
â”œâ”€â”€ logs/                        âœ…
â”œâ”€â”€ checkpoints/                 âœ…
â””â”€â”€ notebooks/                   âœ…
```

### ğŸš€ RunPod ë°°í¬ ì¤€ë¹„ ì™„ë£Œ

1. **ë¡œì»¬ í…ŒìŠ¤íŠ¸** âœ…
   - ë³´ìƒ í•¨ìˆ˜ ê²€ì¦ ì™„ë£Œ
   - ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼

2. **RunPod ì‹¤í–‰ ê°€ì´ë“œ** âœ…
   - GPU ì¶”ì²œ ë° ë¹„ìš© ë¶„ì„
   - Step-by-step ìˆ˜ë™ ì„¤ì •
   - ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

3. **ìë™í™” ê¸°ëŠ¥** âœ…
   - í™˜ê²½ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸
   - í•™ìŠµ ì¤‘ ìƒ˜í”Œ ìë™ ì €ì¥
   - ì§„í–‰ ìƒí™© ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
   - ì²´í¬í¬ì¸íŠ¸ í‰ê°€ ë„êµ¬

---

## ğŸ“Š ë‹¤ìŒ ë‹¨ê³„ (RunPodì—ì„œ ì‹¤í–‰)

### âœ… ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
```bash
# ë³´ìƒ í•¨ìˆ˜ í…ŒìŠ¤íŠ¸ (GPU ë¶ˆí•„ìš”)
cd /Users/kb.yang/Desktop/kb/repo/MiniR1
python scripts/rewards.py
```

### ğŸš€ RunPod ì‹¤í–‰ ìˆœì„œ
**ìƒì„¸ ê°€ì´ë“œ**: `RUNPOD_SETUP.md` ì°¸ê³ 

1. **GPU ì„ íƒ** - RTX 3090/4090/A5000 ì¶”ì²œ
2. **í”„ë¡œì íŠ¸ ì—…ë¡œë“œ** - GitHub ë˜ëŠ” ì§ì ‘ ì—…ë¡œë“œ
3. **UV ì„¤ì¹˜** - `curl -LsSf https://astral.sh/uv/install.sh | sh`
4. **í™˜ê²½ êµ¬ì„±** - PyTorch + ì˜ì¡´ì„± ì„¤ì¹˜
5. **HF ë¡œê·¸ì¸** - `huggingface-cli login`
6. **í™˜ê²½ ê²€ì¦** - `python scripts/check_environment.py`
7. **ë°ì´í„° ì¤€ë¹„** - `python scripts/dataset_prep.py --num_samples 5000`
8. **í•™ìŠµ ì‹œì‘** - `python scripts/train_grpo.py --config configs/training_config.yaml`

---

## ğŸ”¥ í•™ìŠµ ì§„í–‰ ìƒí™© (ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸)

> í•™ìŠµ ì‹œì‘ ì‹œ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.

| Step | Loss | Format Acc | Equation Acc | Success Rate | ì‹œê°„ |
|------|------|------------|--------------|--------------|------|
| - | - | - | - | - | - |

**ì˜ˆìƒ ì§„í–‰**:
- Step 50: í¬ë§· í•™ìŠµ ì™„ë£Œ (~90% format acc)
- Step 100: ì´ˆê¸° ì¶”ë¡  (~15-20% success rate)
- Step 150: íŒ¨í„´ ì¸ì‹ (~30% success rate)
- Step 200: ìˆ˜ë ´ (~35-40% success rate)

---

## ğŸ¯ í•™ìŠµ ëª©í‘œ (200 Steps)

| Checkpoint | ëª©í‘œ | ì„±ê³µë¥  | ì£¼ìš” íŠ¹ì§• |
|-----------|------|--------|----------|
| Step 50 | í¬ë§· í•™ìŠµ | ~90% | `<think></think><answer></answer>` êµ¬ì¡° ìŠµë“ |
| Step 100 | ì´ˆê¸° ì¶”ë¡  | ~15-20% | ë‹¨ìˆœ ê³„ì‚° ì‹œì‘ |
| Step 150 | íŒ¨í„´ ì¸ì‹ | ~30% | ì—°ì‚° ì¡°í•© ì‹œë„ |
| Step 200 | ìˆ˜ë ´ | ~35-40% | ë³µì¡í•œ ì¶”ë¡  íŒ¨í„´ |

---

## ğŸ’¾ ì˜ˆìƒ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰

### GPU ë©”ëª¨ë¦¬
- **ëª¨ë¸ ë¡œë”© (4-bit)**: ~2-3GB
- **í•™ìŠµ ì¤‘**: ~12-16GB
- **ìƒì„± ì‹œ**: ~14-18GB

### ë””ìŠ¤í¬ ê³µê°„
- **ë°ì´í„°ì…‹**: ~100MB
- **ì²´í¬í¬ì¸íŠ¸**: ~2GB/checkpoint Ã— 4 = ~8GB
- **ë¡œê·¸ ë° ìƒ˜í”Œ**: ~500MB

### í•™ìŠµ ì‹œê°„ (ì˜ˆìƒ)
- **RTX 4090**: ~4-6ì‹œê°„ (200 steps)
- **A5000**: ~6-8ì‹œê°„
- **L4**: ~8-12ì‹œê°„

---

## ğŸ“ ë©”ëª¨ ë° ì£¼ì˜ì‚¬í•­

### GPU ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ ëŒ€ì‘ ë°©ì•ˆ
1. `max_completion_length` 512 â†’ 384ë¡œ ê°ì†Œ
2. `gradient_accumulation_steps` 4 â†’ 8ë¡œ ì¦ê°€
3. `num_generations` 2 â†’ 1ë¡œ ê°ì†Œ
4. Qwen2.5-3B â†’ Qwen2.5-1.5Bë¡œ ë³€ê²½

### RunPod íŠ¹í™” íŒ
- UV ìºì‹œ ë””ë ‰í† ë¦¬: `/workspace/.uv` ì„¤ì • ê¶Œì¥
- ì²´í¬í¬ì¸íŠ¸ ìë™ ì €ì¥: `/workspace/checkpoints`ì— ì €ì¥
- ë¡œê·¸ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§: `tail -f logs/training_metrics.json`

---

## ğŸ› ë¬¸ì œ í•´ê²° ê¸°ë¡

(ì•„ì§ ì—†ìŒ)

---

## ğŸ“ˆ ì‹¤í—˜ ê²°ê³¼

(í•™ìŠµ ì™„ë£Œ í›„ ì—…ë°ì´íŠ¸ ì˜ˆì •)

### Checkpoint ë¹„êµ

| Step | Success Rate | Format Accuracy | Avg Reasoning Length | Sample Quality |
|------|--------------|-----------------|---------------------|----------------|
| 50   | TBD | TBD | TBD | TBD |
| 100  | TBD | TBD | TBD | TBD |
| 150  | TBD | TBD | TBD | TBD |
| 200  | TBD | TBD | TBD | TBD |

### ìš°ìˆ˜ ì¶”ë¡  ìƒ˜í”Œ

(í•™ìŠµ ì™„ë£Œ í›„ ì¶”ê°€ ì˜ˆì •)

---

## ğŸ”— ì°¸ê³  ë§í¬

- [ì›ë³¸ íŠœí† ë¦¬ì–¼](https://www.philschmid.de/mini-deepseek-r1)
- [GitHub Notebook](https://github.com/philschmid/deep-learning-pytorch-huggingface/blob/main/training/mini-deepseek-r1-aha-grpo.ipynb)
- [TRL GRPO ë¬¸ì„œ](https://huggingface.co/docs/trl/main/en/grpo_trainer)
- [UV ë¬¸ì„œ](https://docs.astral.sh/uv/)
